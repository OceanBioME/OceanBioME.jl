<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Air-sea gas exchange · OceanBioME.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://OceanBioME.github.io/OceanBioME/stable/model_components/air-sea-gas/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="OceanBioME.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="OceanBioME.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">OceanBioME.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick_start/">Quick start</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/box/">Box model</a></li><li><a class="tocitem" href="../../generated/column/">Simple column model</a></li><li><a class="tocitem" href="../../generated/eady/">Baroclinic instability</a></li><li><a class="tocitem" href="../../generated/data_forced/">Data forced column model</a></li><li><a class="tocitem" href="../../generated/kelp/">Model with particles (kelp) interacting with the biogeochemistry</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model components and setup</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Biogeochemical models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../biogeochemical/">Overview</a></li><li><a class="tocitem" href="../biogeochemical/LOBSTER/">LOBSTER</a></li><li><a class="tocitem" href="../biogeochemical/NPZ/">NPZD</a></li></ul></li><li class="is-active"><a class="tocitem" href>Air-sea gas exchange</a><ul class="internal"><li><a class="tocitem" href="#Model-equations"><span>Model equations</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Sediment models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../sediments/">Overview</a></li><li><a class="tocitem" href="../sediments/simple_multi_g/">Simple Multi-G</a></li><li><a class="tocitem" href="../sediments/instant_remineralisation/">Instant remineralisation</a></li></ul></li><li><a class="tocitem" href="../light/">Light attenuation models</a></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Individuals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../individuals/">Overview</a></li><li><a class="tocitem" href="../individuals/slatissima/">Sugar Kelp (Broch and Slagstad 2012 ++)</a></li></ul></li><li><a class="tocitem" href="../utils/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../model_implementation/">Implementing new models</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../numerical_implementation/positivity-preservation/">Positivity preservation</a></li></ul></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><a class="tocitem" href="../../contributing/">Contibutors guide</a></li><li><a class="tocitem" href="../../references/">References</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../appendix/library/">Library</a></li><li><a class="tocitem" href="../../appendix/function_index/">Function index</a></li><li><input class="collapse-toggle" id="menuitem-10-3" type="checkbox"/><label class="tocitem" for="menuitem-10-3"><span class="docs-label">Parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/Biogeochemistry_parameters/">Biogeochemistry</a></li><li><a class="tocitem" href="../../generated/Biogeochemistry_parameters/">Biogeochemistry</a></li><li><a class="tocitem" href="../../generated/SLatissima_parameters/">SLatissima</a></li><li><a class="tocitem" href="../../generated/TwoBandPhotosyntheticallyActiveRadiation_parameters/">TwoBandPhotosyntheticallyActiveRadiation</a></li><li><a class="tocitem" href="../../generated/SimpleMultiG_parameters/">SimpleMultiG</a></li><li><a class="tocitem" href="../../generated/InstantRemineralisation_parameters/">InstantRemineralisation</a></li><li><a class="tocitem" href="../../generated/OceanBioME.Boundaries.pCO₂_parameters/">OceanBioME.Boundaries.pCO₂</a></li><li><a class="tocitem" href="../../generated/CO₂ air-sea exchange_parameters/">CO₂ air-sea exchange</a></li><li><a class="tocitem" href="../../generated/O₂ air-sea exchange_parameters/">O₂ air-sea exchange</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model components and setup</a></li><li class="is-active"><a href>Air-sea gas exchange</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Air-sea gas exchange</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/OceanBioME/OceanBioME.jl/blob/main/docs/src/model_components/air-sea-gas.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="air-sea-gas"><a class="docs-heading-anchor" href="#air-sea-gas">Air-sea gas exchange</a><a id="air-sea-gas-1"></a><a class="docs-heading-anchor-permalink" href="#air-sea-gas" title="Permalink"></a></h1><p>We currently have one air-sea gas exchange model implemented. The model, proposed by <a href="../../references/#Wanninkhof1992">Wanninkhof (1992)</a>, calculates the solubility of the gas in the water dependent on the temperature and salinity, and calculates the flux depending on the solubility and mixing from the wind.</p><p>Currently, the parameters for CO₂ and oxygen are included, but it would be very straightforward to add the parameters given in the original publication for other gases (e.g. inert tracers of other nutrients such as N₂). We also currently have a very simple formulation of the gas transfer velocity which depends on an average wind speed, but it would straightforwardly be expanded to permit variable wind speed (e.g. to simulate enhanced exchange from storms).</p><p>It is straightforward to set up a boundary as an air-sea gas exchange:</p><pre><code class="language-julia hljs">using OceanBioME

CO₂_flux = GasExchange(; gas = :CO₂)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FluxBoundaryCondition: ContinuousBoundaryFunction gasexchange_function at (Nothing, Nothing, Nothing)</code></pre><p>Where the symbol specifies the exchanged gas (currently <code>:CO₂</code> or <code>:O₂</code>). This can then be passed in the setup of a BGC model, for example:</p><pre><code class="language-julia hljs">using Oceananigans

grid = RectilinearGrid(size=(3, 3, 30), extent=(10, 10, 200));

model = NonhydrostaticModel(; grid,
                              biogeochemistry = LOBSTER(; grid, carbonates = true),
                              boundary_conditions = (DIC = FieldBoundaryConditions(top = CO₂_flux), ))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">NonhydrostaticModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── grid: 3×3×30 RectilinearGrid{Float64, Oceananigans.Grids.Periodic, Oceananigans.Grids.Periodic, Oceananigans.Grids.Bounded} on Oceananigans.Architectures.CPU with 3×3×3 halo
├── timestepper: QuasiAdamsBashforth2TimeStepper
├── tracers: (NO₃, NH₄, P, Z, sPOM, bPOM, DOM, DIC, Alk)
├── closure: Nothing
├── buoyancy: Nothing
└── coriolis: Nothing</code></pre><p>If the temperature and salinity are not included in the model they can be passed as functions (or even anonymous functions):</p><pre><code class="language-julia hljs">T_function(x, y, z, t) = 12.0

CO₂_flux = GasExchange(; gas = :CO₂, temperature = T_function, salinity = (args...) -&gt; 35)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FluxBoundaryCondition: ContinuousBoundaryFunction gasexchange_function at (Nothing, Nothing, Nothing)</code></pre><h2 id="Model-equations"><a class="docs-heading-anchor" href="#Model-equations">Model equations</a><a id="Model-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Model-equations" title="Permalink"></a></h2><h3 id="Gas-transfer"><a class="docs-heading-anchor" href="#Gas-transfer">Gas transfer</a><a id="Gas-transfer-1"></a><a class="docs-heading-anchor-permalink" href="#Gas-transfer" title="Permalink"></a></h3><p>The gas flux is given by:</p><p class="math-container">\[F = k(C_w - \alpha C_a),\]</p><p>where <span>$C_w$</span> is the concentration in the water, <span>$C_a$</span> the concentration in the air, <span>$\alpha$</span> the Oswald solubility coefficient, and <span>$k$</span> the gas transfer velocity. For carbon dioxide the flux is modified to:</p><p class="math-container">\[F = k\beta\rho_o(pCO_{2w} - pCO_{2a}),\]</p><p>where <span>$pCO_{2w}$</span> and <span>$pCO_{2a}$</span> are the partial pressure of carbon dioxide in the water and air, <span>$\beta$</span> is the Bunsen Solubility Coefficient, and <span>$\rho_o$</span> is the density of the water.</p><p>The gas transfer velocity is parameterised by the wind speed and Schmidt number, which in turn is parameterised by the temperature and salinity. The gas transfer velocity is given by:</p><p class="math-container">\[k = 1.08\times10^{-6}u^2\left(\frac{Sc}{660}\right)^{-1/2},\]</p><p>where <span>$u$</span> is the winds speed 10m above the surface, and Sc is the Schmidt number parameterised as:</p><p class="math-container">\[Sc = A - BT + CT^2 - DT^3,\]</p><p>where <span>$T$</span> is temperature in Kelvin and the other parameters are dependent on the gas type and given in <a href="../../appendix/params/#parameters">Parameters</a>.</p><p>The solubilities are given by:</p><p class="math-container">\[\alpha = 0.00367 T \exp{A_1 + 100\frac{A_2}{T} + A_3 \ln{\frac{T}{100}} + S\left(B_1 + \frac{B_2}{T} + \frac{B_3}{T^2}\right)},\]</p><p>and</p><p class="math-container">\[\beta = \exp{A_1 + 100\frac{A_2}{T} + A_3 \ln{\frac{T}{100}} + S\left(B_1 + \frac{B_2}{T} + \frac{B_3}{T^2}\right)},\]</p><p>where <span>$S$</span> is salinity in practical units and the other default parameters are given in <a href="../../appendix/params/#parameters">Parameters</a>.</p><h3 id="Partial-pressure-of-carbon-dioxide"><a class="docs-heading-anchor" href="#Partial-pressure-of-carbon-dioxide">Partial pressure of carbon dioxide</a><a id="Partial-pressure-of-carbon-dioxide-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-pressure-of-carbon-dioxide" title="Permalink"></a></h3><p>We currently do not have the full OCMIP partial pressure formulation, instead we follow the simplified formulation (as used in <a href="../../references/#Aumont2015">Aumont <em>et al.</em> (2015)</a>) where the partial pressure of CO<span>$_2$</span> (<span>$\mu$</span>atm) in gas is found from:</p><p class="math-container">\[pCO_{2a} = f_{CO_2}P_a,\]</p><p>where <span>$f_{CO_2}$</span> is the air fraction (ppmv), and <span>$P_a$</span> is the atmospheric pressure (atm). The ocean partial pressure (<span>$\mu$</span>atm) is derived from the dissolved inorganic carbon content, and alkalinity, as described by <a href="../../references/#tan1998">MacAladay (1998)</a>, from the equilibrium of the following chemical system:</p><p class="math-container">\[\ce{CO_2(g)} \ce{&lt;=&gt; CO_2(aq)},\ K_0=\frac{[\ce{O_2(aq)}]}{\ce{pCO_2}},\]</p><p class="math-container">\[\ce{CO_2(aq) + H_2O}\ce{&lt;=&gt; H^+ + HCO^-_3},\ K_1=\frac{\ce{[HCO^-_3][H^+]}}{\ce{[CO_2(aq)]}},\]</p><p class="math-container">\[\ce{HCO^-_3} \ce{&lt;=&gt; H^+ + CO^{2-}_3},\ K_2=\frac{\ce{[CO^{2-}_3][H^+]}}{\ce{HCO^-_3}},\]</p><p class="math-container">\[\ce{H_2O} \ce{&lt;=&gt; H^+ + OH^-}.\]</p><p>These have rates constants:</p><p class="math-container">\[K_0 = \frac{[\ce{CO_2(aq)}]}{\ce{pCO_2}},\]</p><p class="math-container">\[K_1 = \frac{\ce{[HCO^-_3][H^+]}}{\ce{[CO_2(aq)]}},\]</p><p class="math-container">\[K_2=\frac{\ce{[CO^{2-}_3][H^+]}}{\ce{HCO^-_3}},\]</p><p class="math-container">\[K_w = \ce{[OH^-][H^+]}.\]</p><p>In this system DIC and Alk are defined to be:</p><p class="math-container">\[\ce{DIC} = \ce{[CO_2(aq)] + [HCO^-_3] + [CO_3^{2-}]},\]</p><p class="math-container">\[\ce{Alk} = \ce{[HCO^-_3] + 2[CO^{2-}_3] + [B(OH)^-_4] + [OH^-] - [H^+]  + [OH^-] \pm [minor species]}.\]</p><p>To solve this we must find the Boric acid dissociation from:</p><p class="math-container">\[\ce{B(OH)_3 &lt;=&gt;H^+ + B(OH)^-_4},\ K_B = \frac{\ce{[B(OH)^-_4][H^+]}}{\ce{[B(OH)_3]}},\]</p><p>resulting in the equilibrium constant:</p><p class="math-container">\[K_B = \frac{\ce{[B(OH)^-_4][H^+]}}{\ce{[B(OH)_3]}}.\]</p><p>Finally, taking the DIC and Alkalinity in micro equivalents (i.e. scaled by <span>$10^{-3}/\rho_o$</span> from mmol C/m<span>$^3$</span>) denoted by <span>$\bar{DIC}$</span> and <span>$\bar{Alk}$</span>, the carbonate alkalinity is given by <span>$Alk_C = \bar{Alk} + [B(OH)^-_4] + [OH^-]$</span>, and we define the boron content, <span>$B$</span>, to be <span>$R_{B:S}S$</span> mol/kg.</p><p>The system can be rearranged to give two equations for the carbonate alkalinity:</p><p class="math-container">\[\ce{Alk_C} = DIC\frac{K_1H + 2K^1K^2}{H^2 + K_1H+K_1K_2},\]</p><p class="math-container">\[\ce{Alk_C} = \ce{Alk} - \frac{K_W}{H} - \frac{K_BB}{K_B + H}.\]</p><p>The equilibrium constants (<span>$K_0$</span>, <span>$K_1$</span>, and <span>$K_2$</span>) are given by:</p><p class="math-container">\[K_0  = \exp{\left(A_0 + \frac{B_0}{T} + C_0\log(\frac{T}{100}) + S  (D_0 - E_0T + F_0\left(\frac{T}{100}\right)^2)\right)},\]</p><p class="math-container">\[K_1 = \exp{\left(A_1 - \frac{B_1}{T} - C_1  \log(T) - (D_1 + \frac{E_1}{T})\sqrt{S} + F_1S - G_1S^{1.5}\right)},\]</p><p class="math-container">\[K_2 = \exp{\left(A_2 - \frac{B_2}{T} - C_2 \log(T) - (D_2 + \frac{E_2}{T})\sqrt{S} + F_2S - G_1S^{1.5}\right)},\]</p><p class="math-container">\[K_b = \exp{\left(\frac{A_b - B_b\sqrt{S} - C_bS + D_b  S^{1.5} - E_bS^2}{T} + F_b + G_B  \sqrt{S} + H_b  S - (I_b + J_b \sqrt{S} + S)  \log(T) + L_b  \sqrt{S}  T\right)},\]</p><p class="math-container">\[K_w = \exp{\left(A_w + \frac{B_w}{T} + C_w \ln T + \sqrt{S}\left(D_w + \frac{E_w}{T} + F_w \ln T\right)G_w S\right)}.\]</p><p>We solve these equations iteratively from an initial guess of <span>$pH=8$</span> to find <span>$H$</span>, from which the partial pressure of <span>$CO_2$</span> is calculated as:</p><p class="math-container">\[pCO_2 = 10^6\frac{Alk_CH^2}{K_0(K_1H + 2 K_1K_2)}\]</p><h3 id="Parameter-variable-names"><a class="docs-heading-anchor" href="#Parameter-variable-names">Parameter variable names</a><a id="Parameter-variable-names-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-variable-names" title="Permalink"></a></h3><p>Gas transfer</p><table><tr><th style="text-align: right">Symbol</th><th style="text-align: right">Variable name</th><th style="text-align: right">Units</th></tr><tr><td style="text-align: right"><span>$A$</span>, <span>$B$</span>, <span>$C$</span>, <span>$D$</span></td><td style="text-align: right"><code>schmidt_params</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$A_i$</span> and <span>$B_i$</span> for <span>$i\in[1, 2, 3]$</span></td><td style="text-align: right"><code>solubility_params</code></td><td style="text-align: right">-</td></tr></table><p>Partial pressure of carbon dioxide</p><table><tr><th style="text-align: right">Symbol</th><th style="text-align: right">Variable name</th><th style="text-align: right">Units</th></tr><tr><td style="text-align: right"><span>$L_0$</span> where <span>$L$</span> is a Latin character</td><td style="text-align: right"><code>solubility</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$L_1$</span></td><td style="text-align: right"><code>bicarbonate_dissociation</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$L_2$</span></td><td style="text-align: right"><code>carbonate_dissociation</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$L_b$</span></td><td style="text-align: right"><code>boric_acid_dissociation</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$L_w$</span></td><td style="text-align: right"><code>water_dissociaiton</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$R_{B:S}$</span></td><td style="text-align: right"><code>boron_ratio</code></td><td style="text-align: right">mol B / psu</td></tr><tr><td style="text-align: right"><span>$\alpha$</span></td><td style="text-align: right"><code>thermal_expansion</code></td><td style="text-align: right">1 / °K</td></tr><tr><td style="text-align: right"><span>$\beta$</span></td><td style="text-align: right"><code>haline_contraction</code></td><td style="text-align: right">1 / psu</td></tr></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../biogeochemical/NPZ/">« NPZD</a><a class="docs-footer-nextpage" href="../sediments/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 3 October 2023 16:13">Tuesday 3 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
