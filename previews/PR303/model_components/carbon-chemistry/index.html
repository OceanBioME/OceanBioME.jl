<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Carbon chemistry · OceanBioME.jl</title><meta name="title" content="Carbon chemistry · OceanBioME.jl"/><meta property="og:title" content="Carbon chemistry · OceanBioME.jl"/><meta property="twitter:title" content="Carbon chemistry · OceanBioME.jl"/><meta name="description" content="Documentation for OceanBioME.jl."/><meta property="og:description" content="Documentation for OceanBioME.jl."/><meta property="twitter:description" content="Documentation for OceanBioME.jl."/><meta property="og:url" content="https://OceanBioME.github.io/OceanBioME/stable/model_components/carbon-chemistry/"/><meta property="twitter:url" content="https://OceanBioME.github.io/OceanBioME/stable/model_components/carbon-chemistry/"/><link rel="canonical" href="https://OceanBioME.github.io/OceanBioME/stable/model_components/carbon-chemistry/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="OceanBioME.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="OceanBioME.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">OceanBioME.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick_start/">Quick start</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/box/">Box model</a></li><li><a class="tocitem" href="../../generated/column/">Simple column model</a></li><li><a class="tocitem" href="../../generated/eady/">Baroclinic instability</a></li><li><a class="tocitem" href="../../generated/kelp/">Model with particles (kelp) interacting with the biogeochemistry</a></li><li><a class="tocitem" href="../../generated/data_assimilation/">Data assimilation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model components and setup</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Biogeochemical models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../biogeochemical/">Overview</a></li><li><a class="tocitem" href="../biogeochemical/LOBSTER/">LOBSTER</a></li><li><a class="tocitem" href="../biogeochemical/NPZ/">NPZD</a></li><li><input class="collapse-toggle" id="menuitem-4-1-4" type="checkbox"/><label class="tocitem" for="menuitem-4-1-4"><span class="docs-label">PISCES</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../biogeochemical/PISCES/PISCES/">PISCES</a></li><li><a class="tocitem" href="../biogeochemical/PISCES/notable_differences/">Queries</a></li></ul></li></ul></li><li><a class="tocitem" href="../air-sea-gas/">Air-sea gas exchange</a></li><li class="is-active"><a class="tocitem" href>Carbon chemistry</a><ul class="internal"><li><a class="tocitem" href="#Using-the-model"><span>Using the model</span></a></li><li><a class="tocitem" href="#Chemistry"><span>Chemistry</span></a></li><li><a class="tocitem" href="#Model-parameterisation"><span>Model parameterisation</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Sediment models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../sediments/">Overview</a></li><li><a class="tocitem" href="../sediments/simple_multi_g/">Simple Multi-G</a></li><li><a class="tocitem" href="../sediments/instant_remineralisation/">Instant remineralisation</a></li></ul></li><li><a class="tocitem" href="../light/">Light attenuation models</a></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Individuals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../individuals/">Overview</a></li><li><a class="tocitem" href="../individuals/slatissima/">Sugar Kelp (Broch and Slagstad 2012 ++)</a></li></ul></li><li><a class="tocitem" href="../utils/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../model_implementation/">Implementing new models</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../numerical_implementation/positivity-preservation/">Positivity preservation</a></li></ul></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><a class="tocitem" href="../../contributing/">Contibutors guide</a></li><li><a class="tocitem" href="../../references/">References</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../appendix/library/">Library</a></li><li><a class="tocitem" href="../../appendix/function_index/">Function index</a></li><li><input class="collapse-toggle" id="menuitem-10-3" type="checkbox"/><label class="tocitem" for="menuitem-10-3"><span class="docs-label">Parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/LOBSTER_parameters/">LOBSTER</a></li><li><a class="tocitem" href="../../generated/NutrientPhytoplanktonZooplanktonDetritus_parameters/">NutrientPhytoplanktonZooplanktonDetritus</a></li><li><a class="tocitem" href="../../generated/SugarKelp_parameters/">SugarKelp</a></li><li><a class="tocitem" href="../../generated/TwoBandPhotosyntheticallyActiveRadiation_parameters/">TwoBandPhotosyntheticallyActiveRadiation</a></li><li><a class="tocitem" href="../../generated/OceanBioME.Models.SedimentModels.SimpleMultiG_parameters/">OceanBioME.Models.SedimentModels.SimpleMultiG</a></li><li><a class="tocitem" href="../../generated/OceanBioME.Models.SedimentModels.InstantRemineralisation_parameters/">OceanBioME.Models.SedimentModels.InstantRemineralisation</a></li><li><a class="tocitem" href="../../generated/CarbonChemistry_parameters/">CarbonChemistry</a></li><li><a class="tocitem" href="../../generated/O₂ air-sea exchange_parameters/">O₂ air-sea exchange</a></li><li><a class="tocitem" href="../../generated/O₂ air-sea exchange_parameters/">O₂ air-sea exchange</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model components and setup</a></li><li class="is-active"><a href>Carbon chemistry</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Carbon chemistry</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/OceanBioME/OceanBioME.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/OceanBioME/OceanBioME.jl/blob/main/docs/src/model_components/carbon-chemistry.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="carbon-chemistry"><a class="docs-heading-anchor" href="#carbon-chemistry">Carbon Chemistry</a><a id="carbon-chemistry-1"></a><a class="docs-heading-anchor-permalink" href="#carbon-chemistry" title="Permalink"></a></h1><p>Our carbon chemistry model follows the best practice described by <a href="../../references/#dickson2007">Dickson <em>et al.</em> (2007)</a>, as implemented by e.g. <code>cbsyst</code> (<a href="../../references/#branson2023">Branson, 2023</a>) and <code>CO2SYS</code> (<a href="../../references/#humphreys2022">Humphreys <em>et al.</em>, 2022</a>) in Python.</p><p>The carbon chemistry model is primarily used for diagnosing the partial pressure of carbon dioxide in the surface water for <a href="../air-sea-gas/#air-sea-gas">gas exchange with the air</a>, but is capable of diagnosing other species such as carbonate concentration, useful in the calculation of calcite dissolution. The model works by computing the pH from the total dissolved inorganic carbon and total alkalinity (and optionally silicate, phosphate, boron, sulfate, and fluoride concentration), along with temperature and salinity, which can then be used to find the concentration of different species. We will first describe how to use the model, followed by the underlying chemistry and parameterisations.</p><h2 id="Using-the-model"><a class="docs-heading-anchor" href="#Using-the-model">Using the model</a><a id="Using-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-model" title="Permalink"></a></h2><p>To use the carbon chemistry model it is constructed by simply writing:</p><pre><code class="language-julia hljs">using OceanBioME

carbon_chemistry = CarbonChemistry()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">`CarbonChemistry` model which solves for pCO₂ and pH</code></pre><h3 id="Computing-fCO_2-and-pH"><a class="docs-heading-anchor" href="#Computing-fCO_2-and-pH">Computing <span>$fCO_2$</span> and <span>$pH$</span></a><a id="Computing-fCO_2-and-pH-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-fCO_2-and-pH" title="Permalink"></a></h3><p>To compute the fugacity of carbon dioxide (<span>$fCO_2$</span>) you call the model with the <code>DIC</code>, <code>Alk</code>alinity, <code>T</code>emperature, and <code>S</code>alinity:</p><pre><code class="language-julia hljs">DIC = 2145.0
Alk = 2448.0
T = 25.4
S = 36.45
carbon_chemistry(; DIC, Alk, T, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">460.8490818837613</code></pre><p>This is sufficient when computing <span>$fCO_2$</span> at the surface, but if we wanted to know <span>$fCO_2$</span> at depth where there is higher pressure we can specify the pressure in bar like:</p><pre><code class="language-julia hljs">carbon_chemistry(; DIC, Alk, T, S, P = 100)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">457.1758936301019</code></pre><p>We may also be interested in the pH so we can request that be outputted:</p><pre><code class="language-julia hljs">carbon_chemistry(; DIC, Alk, T, S, return_pH = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8.001440897031806</code></pre><p>These function calls assume a constant boron, sulfate, and fluoride ratio relative to the salinity (as described below), but can be specified instead:</p><pre><code class="language-julia hljs">carbon_chemistry(; DIC, Alk, T, S, boron = 0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">305.0230153445105</code></pre><p>And the silicate and phosphate concentrations are assumed to be zero but can similarly be specified:</p><pre><code class="language-julia hljs">carbon_chemistry(; DIC, Alk, T, S, silicate = 2, phosphate = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">462.961060028668</code></pre><p>The same code can also be used to compute <span>$fCO_2$</span> when the pH is already known by passing it in the same way:</p><pre><code class="language-julia hljs">carbon_chemistry(; DIC, pH = 8.1, T, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">358.4572891858634</code></pre><p>Finally, for slightly improved accuracy you may wish to specify that the seawater density calculation, is an intermediary step in the calculations above, is computed using the full TEOS-10 <a href="../../references/#feistel2008">Feistel (2008)</a> standard by setting this as the <code>density_function</code> when you construct the carbon chemistry model:</p><pre><code class="language-julia hljs">using OceanBioME.Models: teos10_density
carbon_chemistry = CarbonChemistry(; density_function = teos10_density)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">`CarbonChemistry` model which solves for pCO₂ and pH</code></pre><p>But this comes at the cost of significantly increased computational expense and GPU incompatability.</p><p>During the conversion from practical to absolute salinity units the location can then also be entered for (very slightly, in this example ~<span>$10^{-4}\mu$</span>atm) improved accuracy:</p><pre><code class="language-julia hljs">carbon_chemistry(; DIC, Alk, T, S, lon = -31.52, lat = 33.75)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">460.812912879999</code></pre><p>The default uses the polynomial approximation described in <a href="../../references/#roquet2015">Roquet <em>et al.</em> (2015)</a> as provided by <a href="https://github.com/CliMA/SeawaterPolynomials.jl/"><code>SeawaterPolynomials.jl</code></a>.</p><h3 id="Computing-the-carbonate-concentration"><a class="docs-heading-anchor" href="#Computing-the-carbonate-concentration">Computing the carbonate concentration</a><a id="Computing-the-carbonate-concentration-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-carbonate-concentration" title="Permalink"></a></h3><p>So that this model can be used in calcite dissolution models it can also return the carbonate saturation by calling the function <code>calcite_saturation</code></p><pre><code class="language-julia hljs">using OceanBioME.Models.CarbonChemistryModel: calcite_saturation

calcite_saturation(carbon_chemistry; DIC, Alk, T, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.001301242857483965</code></pre><p>This function takes all of the same arguments (e.g. <code>boron</code>) as <code>carbon_chemistry</code> above.</p><h2 id="Chemistry"><a class="docs-heading-anchor" href="#Chemistry">Chemistry</a><a id="Chemistry-1"></a><a class="docs-heading-anchor-permalink" href="#Chemistry" title="Permalink"></a></h2><h3 id="pH-computation"><a class="docs-heading-anchor" href="#pH-computation">pH computation</a><a id="pH-computation-1"></a><a class="docs-heading-anchor-permalink" href="#pH-computation" title="Permalink"></a></h3><p>When carbon dioxide is dissolved in seawater it dissociates into carbonate and bicarbonate species according to the equilibria:</p><p class="math-container">\[\ce{CO_2(g)} \ce{&lt;=&gt; CO_2(aq)},\]</p><p class="math-container">\[\ce{CO_2(aq)} + \ce{H_2O} \ce{&lt;=&gt; H_2CO_3(aq)},\]</p><p class="math-container">\[\ce{CO_2(aq) + H_2O}\ce{&lt;=&gt; H^+ HCO^-_3},\]</p><p class="math-container">\[\ce{HCO^-_3} \ce{&lt;=&gt; H^+ + CO^{2-}_3},\]</p><p>from which we define the total dissolved inorganic carbon (<code>DIC</code>) to be <span>$DIC = [\ce{CO_2(aq)}] + [\ce{HCO^-_3}] + [\ce{CO^{2-}_3}]$</span>.  The equilibrium constants for these equations are defined as:</p><p class="math-container">\[K_0=\frac{[\ce{CO_2(aq)}]}{\ce{pCO_2}},\]</p><p class="math-container">\[K_1=\frac{\ce{[HCO^-_3][H^+]}}{\ce{[CO_2(aq)]}},\]</p><p>and</p><p class="math-container">\[K_2=\frac{\ce{[CO^{2-}_3][H^+]}}{\ce{[HCO^-_3]}}.\]</p><p>These equilibria depend on the total hydrogen ion concentration <span>$[H^+]$</span>, which depends on the concentration of acids and buffering of bases.</p><h4 id="Alkalinity:-acid-base-buffering"><a class="docs-heading-anchor" href="#Alkalinity:-acid-base-buffering">Alkalinity: acid-base buffering</a><a id="Alkalinity:-acid-base-buffering-1"></a><a class="docs-heading-anchor-permalink" href="#Alkalinity:-acid-base-buffering" title="Permalink"></a></h4><p>Alkalinity is a measure of the buffering capacity of seawater and we can approximate it as:</p><p class="math-container">\[Alk = [\ce{HCO_3^-}] + 2[\ce{CO_3^{2-}}] + [\ce{B(OH)_4^-}] + [\ce{OH^-}] + [\ce{HPO_4^{2-}}] + 2[\ce{PO_4^{3-}}] + [\ce{SiO(OH)_3^-}] + [\ce{NH_3}] + [\ce{HS^-}] - [\ce{H^+}] - [\ce{HSO_4^-}] - [\ce{HF}] - [\ce{H_3PO_4}] + \text{ minor acids and bases},\]</p><p>where the &quot;minor&quot; species are either in sufficiently low concentrations as to be neglected (sometimes the photphate, silicate and sulfate species can also be neglected), and we shall neglect <span>$[\ce{NH_3}]$</span>.</p><p>Each of these acid and base species are also in an equilibrated dissociation state given below.</p><h4 id="Hydrogen-sulfate"><a class="docs-heading-anchor" href="#Hydrogen-sulfate">Hydrogen sulfate</a><a id="Hydrogen-sulfate-1"></a><a class="docs-heading-anchor-permalink" href="#Hydrogen-sulfate" title="Permalink"></a></h4><p>Sulfate in the form of hydrogen sulfate dissociates to form sulfate ions in the equilibrium</p><p class="math-container">\[\ce{HSO_4^-}\ce{&lt;=&gt; H^+ + SO_4^{2-}},\]</p><p>with an equilibrium constant given by</p><p class="math-container">\[K_S=\frac{\ce{[SO_4^{2-}][H^+]}}{\ce{[HSO_4^-]}}.\]</p><h4 id="Boric-acid"><a class="docs-heading-anchor" href="#Boric-acid">Boric acid</a><a id="Boric-acid-1"></a><a class="docs-heading-anchor-permalink" href="#Boric-acid" title="Permalink"></a></h4><p>Boron in the form of boric acid equilibrates with water in the reaction</p><p class="math-container">\[\ce{B(OH)_3+H_2O}\ce{&lt;=&gt; H^+ + B(OH)_4^-},\]</p><p>with equilibrium constant</p><p class="math-container">\[K_B=\frac{\ce{[B(OH)_4^-][H^+]}}{\ce{[B(OH)_3]}}.\]</p><h4 id="Hydrogen-fluoride"><a class="docs-heading-anchor" href="#Hydrogen-fluoride">Hydrogen fluoride</a><a id="Hydrogen-fluoride-1"></a><a class="docs-heading-anchor-permalink" href="#Hydrogen-fluoride" title="Permalink"></a></h4><p>Hydrogen fluoride dissociated in the equilibrium</p><p class="math-container">\[\ce{HF}\ce{&lt;=&gt; H^+ + F^-},\]</p><p>with equilibrium constant</p><p class="math-container">\[K_F=\frac{\ce{[F^-][H^+]}}{\ce{[HF]}}.\]</p><h4 id="Phosphoric-acid"><a class="docs-heading-anchor" href="#Phosphoric-acid">Phosphoric acid</a><a id="Phosphoric-acid-1"></a><a class="docs-heading-anchor-permalink" href="#Phosphoric-acid" title="Permalink"></a></h4><p>Phosphoric acid undergoes a three stage dissociation given by the equilibrium</p><p class="math-container">\[\ce{H_3PO_4}\ce{&lt;=&gt; H^+ + H_2PO_4^-},\]</p><p class="math-container">\[\ce{H_2PO_4^-}\ce{&lt;=&gt; H^+ + HPO_4^{2-}},\]</p><p class="math-container">\[\ce{HPO_4^{2-}}\ce{&lt;=&gt; H^+ + PO_4^{3-}},\]</p><p>with equilibrium constants</p><p class="math-container">\[K_{P1} = \frac{\ce{[H^+][H_2PO_4^-]}}{\ce{[H_3PO_4]}},\]</p><p class="math-container">\[K_{P2} = \frac{\ce{[H^+][HPO_4^{2-}]}}{\ce{[H_2PO_4^-]}},\]</p><p class="math-container">\[K_{P3} = \frac{\ce{[H^+][PO_4^{3-}]}}{\ce{[HPO_4^{2-}]}}.\]</p><h4 id="Silicic-acid"><a class="docs-heading-anchor" href="#Silicic-acid">Silicic acid</a><a id="Silicic-acid-1"></a><a class="docs-heading-anchor-permalink" href="#Silicic-acid" title="Permalink"></a></h4><p>Silicic acid dissociates in the equilibrium</p><p class="math-container">\[\ce{Si(OH)_4}\ce{&lt;=&gt; H^+ + SiO(OH)_3^-},\]</p><p>with equilibrium constant</p><p class="math-container">\[K_{Si} = \frac{\ce{[H^+][SiO(OH)_3^-]}}{\ce{[Si(OH)_4]}}.\]</p><h4 id="Water"><a class="docs-heading-anchor" href="#Water">Water</a><a id="Water-1"></a><a class="docs-heading-anchor-permalink" href="#Water" title="Permalink"></a></h4><p>Finally, water dissociates in the equilibrium</p><p class="math-container">\[\ce{H_2O}\ce{&lt;=&gt; H^+ + OH^-},\]</p><p>with equilibrium constant</p><p class="math-container">\[K_w = \ce{[H^+][OH^-]}.\]</p><h4 id="Alkalinity-equilibration"><a class="docs-heading-anchor" href="#Alkalinity-equilibration">Alkalinity equilibration</a><a id="Alkalinity-equilibration-1"></a><a class="docs-heading-anchor-permalink" href="#Alkalinity-equilibration" title="Permalink"></a></h4><p>From these rate constants we can rewrite the total alkalinity (given above) in terms of only the rate constants, total hydrogen ion concentration (<span>$\ce{H^+}$</span>), the total dissolved inorganic carbon (<span>$[DIC]$</span>), boron (<span>$[\text{B}]$</span>), phosphate (<span>$[\text{P}]$</span>), silicate (<span>$[\text{Si}]$</span>), Sulfate (<span>$[\text{Sulf}]$</span>), and fluorine (<span>$[\text{F}]$</span>) content of the water, by rearranging the equations above.  This results in a form of the total alkalinity:</p><p class="math-container">\[\begin{align}
Alk &amp;\approx \frac{[DIC][\ce{H^+}]K_1}{[\ce{H^+}]^2 + K_1[\ce{H^+}] + K_1K_2}\\
    &amp;+ \frac{2[DIC]K_1K_2}{[\ce{H^+}]^2 + K_1[\ce{H^+}] + K_1K_2}\\
    &amp;+ \frac{[\text{B}]}{1+[\ce{H^+}]/K_B}\\
    &amp;+ \frac{K_w}{[\ce{H^+}]}\\
    &amp;+ \frac{[\text{P}][\ce{H^+}]K_{P1}K_{P2}}{[\ce{H^+}]^3+K_{P1}[\ce{H^+}]^2+K_{P1}K_{P2}[\ce{H^+}] + K_{P1}K_{P2}K_{P3}}\\
    &amp;+ \frac{2[\text{P}]K_{P1}K_{P2}K_{P3}}{[\ce{H^+}]^3+K_{P1}[\ce{H^+}]^2+K_{P1}K_{P2}[\ce{H^+}] + K_{P1}K_{P2}K_{P3}}\\
    &amp;+ \frac{[\text{Si}]}{1+[\ce{H^+}]/K_{Si}}\\
    &amp;- \frac{[\ce{H^+}]}{1+\text{S}/K_S}\\
    &amp;- \frac{[\text{Sulf}]}{1+K_S/[\ce{H^+}]/(1+S/K_S)}\\
    &amp;- \frac{[\text{F}]}{1+K_F/[\ce{H^+}]}\\
    &amp;- \frac{[\ce{H^+}]^2}{[\ce{H^+}]^3+K_{P1}[\ce{H^+}]^2+K_{P1}K_{P2}[\ce{H^+}] + K_{P1}K_{P2}K_{P3}}.
\end{align}\]</p><p>This gives us a second equation from total alkalinity (which we must already know) with one unknown, <span>$[\ce{H^+}]$</span>.  Our model solves for <span>$[\ce{H^+}]$</span> using a bisection method to an accuracy of <span>$10^{-10}$</span>, having approximated the equilibrium constants from parametrisations described below. We can then determine the pH as, <span>$pH = -\log_{10}([\ce{H^+}])$</span>.</p><h3 id="Carbon-dioxide"><a class="docs-heading-anchor" href="#Carbon-dioxide">Carbon dioxide</a><a id="Carbon-dioxide-1"></a><a class="docs-heading-anchor-permalink" href="#Carbon-dioxide" title="Permalink"></a></h3><p>Now that we know <span>$[DIC]$</span>, <span>$Alk$</span>, and <span>$[\ce{H^+}]$</span> we can return to the equation for total dissolved inorganic carbon to find the concentration of aqueous carbon dioxide</p><p class="math-container">\[[CO_2(aq)] = \frac{[DIC][\ce{H^+}]^2}{[\ce{H^+}]^2 + K_1[\ce{H^+}] + K_1K_2},\]</p><p>from which we determine gas phase carbon dioxide concentration as</p><p class="math-container">\[fCO_2 = \frac{[CO_2(aq)]}{K_0},\]</p><p>in atmospheres.</p><h3 id="Carbonate-concentration-and-calcite-saturation"><a class="docs-heading-anchor" href="#Carbonate-concentration-and-calcite-saturation">Carbonate concentration and calcite saturation</a><a id="Carbonate-concentration-and-calcite-saturation-1"></a><a class="docs-heading-anchor-permalink" href="#Carbonate-concentration-and-calcite-saturation" title="Permalink"></a></h3><p>Similarly we can also diagnose the calcite concentration</p><p class="math-container">\[[CO_3^{2-}] = \frac{[DIC]K_1K_2}{[\ce{H^+}]([\ce{H^+}] + K_1)+K_1K_2}.\]</p><p>This concentration is important in the dissolution of calcium carbonate which reacts according to the equilibrium</p><p class="math-container">\[\ce{CaCO_3(aq)}\ce{&lt;=&gt; Ca^+ + CO_3^{2-}},\]</p><p>which has an equilibrium constant</p><p class="math-container">\[K_{SP} = [\ce{Ca^{2+}}][\ce{CO_3^{2-}}].\]</p><p>The calcite saturation can then be defined as <span>$\Omega=\frac{[\ce{CO_3^{2-}}]}{[\ce{CO_{3, saturation}^{2-}}]}$</span> which can be diagnosed as:</p><p class="math-container">\[\Omega = \frac{[\ce{Ca^{2+}}][\ce{CO_3^{2-}}]}{K_{SP}}.\]</p><h3 id="Missing-pieces"><a class="docs-heading-anchor" href="#Missing-pieces">Missing pieces</a><a id="Missing-pieces-1"></a><a class="docs-heading-anchor-permalink" href="#Missing-pieces" title="Permalink"></a></h3><p>In most cases the chemistry described above requires information about more elements that is usually available. This means that we must parameterise their concentrations, usually this results in the boron, sulfate, and fluoride concentrations being set as constant ratios of the salinity.  Usually these ratios are:</p><p class="math-container">\[\begin{align}
[\text{B}] &amp;= \frac{0.000232}{10.811}\frac{S}{1.80655},\\
[\text{S}] &amp;= \frac{0.14}{96.06} \frac{S}{1.80655},\\
[\text{F}] &amp;= \frac{0.000067}{18.9984} \frac{S}{1.80655}.\\
\end{align}\]</p><p>We use these ratios by default in the model (but they can be changed when calling the models functions described below). Additionally, silicate and phosphate concentrations are often unavailable (both in observations and models), so are by default set to zero and their alkalinity contribution assumed to be small.</p><p>The &quot;ionic strength&quot; must also be parameterised for some equilibrium constants and is usually assumed to be:</p><p class="math-container">\[Is = \frac{19.924}{1000 - 1.005S},\]</p><p>but these parameters are also variable in the model.</p><h2 id="Model-parameterisation"><a class="docs-heading-anchor" href="#Model-parameterisation">Model parameterisation</a><a id="Model-parameterisation-1"></a><a class="docs-heading-anchor-permalink" href="#Model-parameterisation" title="Permalink"></a></h2><p>The chemical system described above has a large number of equilibrium constants, the constants are typically assumed to depend on the temperature, salinity, and pressure (hydrostatic pressure from depth underwater). [//]: # (This sentence is not currently actually true, but will be by the time of PR merge) By default, this model parameterises them based on the &quot;best practice&quot; guidelines of <a href="../../references/#dickson2007">Dickson <em>et al.</em> (2007)</a>. These parameterisations are:</p><pre><code class="language-julia hljs">using OceanBioME.Models.CarbonChemistryModel: K0, K1, K2, KB, KW, KS, KF, KP1, KP2, KP3, KSi, KSP_calcite, KSP_aragonite
K0() # Weiss &amp; Price (1980, Mar. Chem., 8, 347-359; Eq 13 with table 6 values)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Solubility constant
    ln(k₀/k°) = -60.2409 + 9345.17 / T + 23.3585 (log(T) - log(100)) + 0.0 T² + (0.023517 + -0.00023656 T + 4.7036e-7 T²)S</code></pre><pre><code class="language-julia hljs">K1() # Millero (1995, Geochim. Cosmochim. Acta, 59, 664)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">First carbon dioxide dissociation constant
    log₁₀(k₁/k°) = 61.2172 + -3633.86 / T + -9.6777 log(T) + 0.011555 S + -0.0001152 S²</code></pre><pre><code class="language-julia hljs">K2() # Millero (1995, Geochim. Cosmochim. Acta, 59, 664)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Second carbon dioxide dissociation constant
    log₁₀(k₂/k°) = -25.929 + -471.78 / T + 3.16967 log(T) + 0.01781 S + -0.0001122 S²</code></pre><pre><code class="language-julia hljs">KB() # Dickson (1990, Deep-Sea Res., 37, 755–766)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Boric acid dissociation constant
    ln(kᵇ/k°) = 148.0248 + (-8966.9 + -2890.53 √S + -77.942 S + 1.728 √S³ + -0.0996 S²) / T
                + 137.1942 * √S
                + 1.62142 * S
                + (-24.4344 + -25.085 √S + -0.2474 S ) * log(T)
                + 0.053105 * √S * T</code></pre><pre><code class="language-julia hljs">KW() # Millero (1995, Geochim. Cosmochim. Acta, 59, 661–677)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Water dissociation constant
    ln(kʷ/k°) = 148.9652
                + -13847.26 / T
                + -23.6521 log(T)
                + (-5.977 + 118.67 / T + 1.0495 log(T)) √S
                + -0.01615 * S</code></pre><pre><code class="language-julia hljs">KS() # Dickson (1990, Chem. Thermodyn., 22, 113–127)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Bisulfate dissociation constant
    ln(kˢ/k°) = 141.328
                + -4276.1 / T
                + -23.093 log(T)
                + (324.57 + -13856.0 / T + -47.986 log(T)) √Is
                + (-771.54 + 35474.0 / T + 114.723 log(T)) Is
                + -2698.0 √Is³ / T
                + 1776.0 Is² / T
                + log(1 + -0.001005 S)</code></pre><pre><code class="language-julia hljs">KF() # Dickson and Riley (1979, Mar. Chem., 7, 89–99)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Hydrogen fluoride dissociation constant
    ln(kᶠ/k°) = -9.68
                + 874.0 / T
                + 0.111 √S
                + log(1 + 0.0 S)
                + log(1 + 0.0 S / Kˢ)</code></pre><pre><code class="language-julia hljs">KP1() # Millero (1995, Geochim. Cosmochim. Acta, 59, 661–677)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Phosphate dissociation constant
    ln(kᵖⁿ/k°) = 115.525
                + -4576.752 / T
                + -18.453 log(T)
                + (0.69171 + -106.736 / T) √S
                + (-0.01844 + -0.65643 / T) S</code></pre><pre><code class="language-julia hljs">KP2() # Millero (1995, Geochim. Cosmochim. Acta, 59, 661–677)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Phosphate dissociation constant
    ln(kᵖⁿ/k°) = 172.0883
                + -8814.715 / T
                + -27.927 log(T)
                + (1.3566 + -160.34 / T) √S
                + (-0.05778 + 0.37335 / T) S</code></pre><pre><code class="language-julia hljs">KP3() # Millero (1995, Geochim. Cosmochim. Acta, 59, 661–677)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Phosphate dissociation constant
    ln(kᵖⁿ/k°) = -18.141
                + -3070.75 / T
                + 0.0 log(T)
                + (2.81197 + 17.27039 / T) √S
                + (-0.09984 + -44.99486 / T) S</code></pre><pre><code class="language-julia hljs">KSi() # Millero (1995, Geochim. Cosmochim. Acta, 59, 661–677)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Silicic acid constant
    ln(kˢⁱ/k°) = 117.385
                + -8904.2 / T
                + -19.334 log(T)
                + (3.5913 + -458.79 / T) √Is
                + (-1.5998 + 188.74 / T) Is
                + (0.07871 + -12.1652 / T) Is²
                + log(1 + -0.001005 S)</code></pre><pre><code class="language-julia hljs">KSP_calcite() # Millero, F. J. (2007, Chemical Reviews, 107(2), 308–341)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Calcite solubility
    ln(kₛₚ) = -171.9065 + -0.077993 T + 2839.319 / T + 71.595 log(T)
    ln(kₛₚˢ) = ln(kₛₚ) + (-0.77712 + 0.0028426 T + 178.34 / T) √S
                + -0.07711 S + 0.0041249 √S³</code></pre><pre><code class="language-julia hljs">KSP_aragonite() # Millero, F. J. (2007, Chemical Reviews, 107(2), 308–341)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Calcite solubility
    ln(kₛₚ) = -171.945 + -0.077993 T + 2903.293 / T + 71.595 log(T)
    ln(kₛₚˢ) = ln(kₛₚ) + (-0.068393 + 0.0017276 T + 88.135 / T) √S
                + -0.10018 S + 0.0059415 √S³</code></pre><p>The pressure corrections from Millero, F. J. (2007, Chemical Reviews, 107(2), 308–341) are:</p><pre><code class="language-julia hljs">K1().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -25.5 + 0.1271 Tc + 0.0 * Tc²
    Δκ = -0.00308 + 8.77e-5 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre><pre><code class="language-julia hljs">K2().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -15.82 + -0.0219 Tc + 0.0 * Tc²
    Δκ = 0.00113 + -0.0001475 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre><pre><code class="language-julia hljs">KB().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -29.48 + 0.1622 Tc + -0.002608 * Tc²
    Δκ = -0.00284 + 0.0 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre><pre><code class="language-julia hljs">KW().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -20.02 + 0.1119 Tc + -0.001409 * Tc²
    Δκ = -0.00513 + 7.94e-5 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre><pre><code class="language-julia hljs">KS().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -18.03 + 0.0466 Tc + 0.000316 * Tc²
    Δκ = -0.00453 + 9.0e-5 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre><pre><code class="language-julia hljs">KF().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -9.78 + -0.009 Tc + -0.000942 * Tc²
    Δκ = -0.00391 + 5.4e-5 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre><pre><code class="language-julia hljs">KP1().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -14.51 + 0.1211 Tc + -0.000321 * Tc²
    Δκ = -0.00267 + 4.27e-5 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre><pre><code class="language-julia hljs">KP2().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -23.12 + 0.1758 Tc + -0.002647 * Tc²
    Δκ = -0.00515 + 9.0e-5 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre><pre><code class="language-julia hljs">KP3().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -26.57 + 0.202 Tc + -0.003042 * Tc²
    Δκ = -0.00408 + 7.14e-5 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre><pre><code class="language-julia hljs">KSP_calcite().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -48.76 + 0.5304 Tc + -0.0 * Tc²
    Δκ = -0.01176 + 0.0003692 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre><pre><code class="language-julia hljs">KSP_aragonite().pressure_correction</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Equilibrium constant pressure correction
    ΔV = -45.96 + 0.5304 Tc + -0.0 * Tc²
    Δκ = -0.01176 + 0.0003692 T
    ln(kᵖ/k⁰) = (-ΔV + Δκ P / 2) * P / RT</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../air-sea-gas/">« Air-sea gas exchange</a><a class="docs-footer-nextpage" href="../sediments/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 23 October 2025 15:46">Thursday 23 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
