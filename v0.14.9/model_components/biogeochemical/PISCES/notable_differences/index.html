<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Queries · OceanBioME.jl</title><meta name="title" content="Queries · OceanBioME.jl"/><meta property="og:title" content="Queries · OceanBioME.jl"/><meta property="twitter:title" content="Queries · OceanBioME.jl"/><meta name="description" content="Documentation for OceanBioME.jl."/><meta property="og:description" content="Documentation for OceanBioME.jl."/><meta property="twitter:description" content="Documentation for OceanBioME.jl."/><meta property="og:url" content="https://OceanBioME.github.io/OceanBioME/stable/model_components/biogeochemical/PISCES/notable_differences/"/><meta property="twitter:url" content="https://OceanBioME.github.io/OceanBioME/stable/model_components/biogeochemical/PISCES/notable_differences/"/><link rel="canonical" href="https://OceanBioME.github.io/OceanBioME/stable/model_components/biogeochemical/PISCES/notable_differences/"/><script data-outdated-warner src="../../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../search_index.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script><link href="../../../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img class="docs-light-only" src="../../../../assets/logo.png" alt="OceanBioME.jl logo"/><img class="docs-dark-only" src="../../../../assets/logo-dark.png" alt="OceanBioME.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../../">OceanBioME.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><a class="tocitem" href="../../../../quick_start/">Quick start</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/box/">Box model</a></li><li><a class="tocitem" href="../../../../generated/column/">Simple column model</a></li><li><a class="tocitem" href="../../../../generated/eady/">Baroclinic instability</a></li><li><a class="tocitem" href="../../../../generated/kelp/">Model with particles (kelp) interacting with the biogeochemistry</a></li><li><a class="tocitem" href="../../../../generated/data_assimilation/">Data assimilation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model components and setup</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Biogeochemical models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../">Overview</a></li><li><a class="tocitem" href="../../LOBSTER/">LOBSTER</a></li><li><a class="tocitem" href="../../NPZ/">NPZD</a></li><li><input class="collapse-toggle" id="menuitem-4-1-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1-4"><span class="docs-label">PISCES</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../PISCES/">PISCES</a></li><li class="is-active"><a class="tocitem" href>Queries</a><ul class="internal"><li><a class="tocitem" href="#Preface"><span>Preface</span></a></li><li><a class="tocitem" href="#Constant-disparities"><span>Constant disparities</span></a></li><li><a class="tocitem" href="#Equation-disparities"><span>Equation disparities</span></a></li><li><a class="tocitem" href="#Changes-since-[Aumont2015](@citet)-in-NEMO"><span>Changes since Aumont <em>et al.</em> (2015) in NEMO</span></a></li></ul></li></ul></li></ul></li><li><a class="tocitem" href="../../../air-sea-gas/">Air-sea gas exchange</a></li><li><a class="tocitem" href="../../../carbon-chemistry/">Carbon chemistry</a></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Sediment models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../sediments/">Overview</a></li><li><a class="tocitem" href="../../../sediments/simple_multi_g/">Simple Multi-G</a></li><li><a class="tocitem" href="../../../sediments/instant_remineralisation/">Instant remineralisation</a></li></ul></li><li><a class="tocitem" href="../../../light/">Light attenuation models</a></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Individuals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../individuals/">Overview</a></li><li><a class="tocitem" href="../../../individuals/slatissima/">Sugar Kelp (Broch and Slagstad 2012 ++)</a></li></ul></li><li><a class="tocitem" href="../../../utils/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../../../model_implementation/">Implementing new models</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../numerical_implementation/positivity-preservation/">Positivity preservation</a></li></ul></li><li><a class="tocitem" href="../../../../visualization/">Visualization</a></li><li><a class="tocitem" href="../../../../contributing/">Contibutors guide</a></li><li><a class="tocitem" href="../../../../references/">References</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../appendix/library/">Library</a></li><li><a class="tocitem" href="../../../../appendix/function_index/">Function index</a></li><li><input class="collapse-toggle" id="menuitem-10-3" type="checkbox"/><label class="tocitem" for="menuitem-10-3"><span class="docs-label">Parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/LOBSTER_parameters/">LOBSTER</a></li><li><a class="tocitem" href="../../../../generated/NutrientPhytoplanktonZooplanktonDetritus_parameters/">NutrientPhytoplanktonZooplanktonDetritus</a></li><li><a class="tocitem" href="../../../../generated/SugarKelp_parameters/">SugarKelp</a></li><li><a class="tocitem" href="../../../../generated/TwoBandPhotosyntheticallyActiveRadiation_parameters/">TwoBandPhotosyntheticallyActiveRadiation</a></li><li><a class="tocitem" href="../../../../generated/OceanBioME.Models.SedimentModels.SimpleMultiG_parameters/">OceanBioME.Models.SedimentModels.SimpleMultiG</a></li><li><a class="tocitem" href="../../../../generated/OceanBioME.Models.SedimentModels.InstantRemineralisation_parameters/">OceanBioME.Models.SedimentModels.InstantRemineralisation</a></li><li><a class="tocitem" href="../../../../generated/CarbonChemistry_parameters/">CarbonChemistry</a></li><li><a class="tocitem" href="../../../../generated/O₂ air-sea exchange_parameters/">O₂ air-sea exchange</a></li><li><a class="tocitem" href="../../../../generated/O₂ air-sea exchange_parameters/">O₂ air-sea exchange</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model components and setup</a></li><li><a class="is-disabled">Biogeochemical models</a></li><li><a class="is-disabled">PISCES</a></li><li class="is-active"><a href>Queries</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Queries</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/OceanBioME/OceanBioME.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/OceanBioME/OceanBioME.jl/blob/main/docs/src/model_components/biogeochemical/PISCES/notable_differences.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PISCES_queries"><a class="docs-heading-anchor" href="#PISCES_queries">Notes</a><a id="PISCES_queries-1"></a><a class="docs-heading-anchor-permalink" href="#PISCES_queries" title="Permalink"></a></h1><p>While most of the function formulae can be found in <a href="../../../../references/#Aumont2015">Aumont <em>et al.</em> (2015)</a>, we have compiled the following list of minor errors in the paper, as well as changes that are present in the <a href="https://www.nemo-ocean.eu/">NEMO</a> implementation.</p><h2 id="Preface"><a class="docs-heading-anchor" href="#Preface">Preface</a><a id="Preface-1"></a><a class="docs-heading-anchor-permalink" href="#Preface" title="Permalink"></a></h2><p>The OceanBioME implementation of PISCES varies from NEMO and CROCCO in a few regards:</p><ul><li>Our standard unit of concentration is mmol / m³ which is equivalent to μmol / L, so we have retained these units all the tracers except iron</li><li>Iron is modelled in μmol / m³ which is equivalent to nmol / L</li><li>In other implementations of PISCES nitrogen is tracked in carbon units (i.e. the concentration of nitrogen divided by the Redfield ratio). We instead opted to track in nitrogen units and so multiply most terms by the Redfield ratio (TODO: check that constants are in the correct units)</li><li><a href="../../../../references/#Aumont2015">Aumont <em>et al.</em> (2015)</a> refers to the concentrations in μmol / L and nmol / L. The NEMO and CROCCO source code track everything in mol/L, therefore many units were converted, but some were missed (listed below)</li><li><a href="../../../../references/#Aumont2015">Aumont <em>et al.</em> (2015)</a> includes the &quot;yearly maximum silicate&quot;, <code>Si′</code> but it appears that the NEMO source code uses the surface silicate, so we have renamed it to <code>silicate_climatology</code></li><li>Other implementations of PISCES compute the dark residence time (the time spent below the euphotic depth due to mixing within the mixed layer) assuming a constant diffusivity. We replaced this with the actual diffusivity (or it can be set to a <code>ConstantField</code> to replicate other results)</li><li>We have removed dust from PISCES since it can be implemented as a more generic model elsewhere, and doesn&#39;t actually appear in PISCES except in the iron scavenging term which would need to be added as a forcing if iron scavenging from dust was desired in a model.</li><li>The bacterial remineralisation of DOC is split into the oxic and anoxic parts which are referred to as <span>$Remin$</span> and <span>$Denit$</span>, but we have renamed these as <code>oxic_remineralisation</code> and <code>anoxic_remineralisation</code> for clarity</li><li>We would also like to note for future developers that <span>$\theta^{Chl}$</span> is mg Chl / mg C so needs to be computed as <span>$IChl / 12I$</span></li></ul><h2 id="Constant-disparities"><a class="docs-heading-anchor" href="#Constant-disparities">Constant disparities</a><a id="Constant-disparities-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-disparities" title="Permalink"></a></h2><p>We believe that units of some constants were incorrect in <a href="../../../../references/#Aumont2015">Aumont <em>et al.</em> (2015)</a>, all units are now all noted in the code and may vary.  The values vary for:</p><ul><li>Aggregation factors (<span>$a_1, a_2, ...$</span>), found in <code>TwoCompartementCarbonIronParticles</code> and <code>DissolvedOrganicCarbon</code> <code>aggregation_parameters</code>: from the NEMO source code, all of these parameters need a factor of <span>$10^{-6}$</span> to convert them from units of 1 / (mol / L) to 1 / (μmol / L). Additionally, all the parameters require a factor of <span>$1 / 86400$</span>, for the parameters not multiplied by shear this straight forwardly is because they have time units of 1 / day in the NEMO code, but for those multiplied by shear this is because they implicitly have a factor of seconds per day in them to result in an aggregation in mmol C / day</li><li>In a similar vein, the flux feeding rate for zooplankton <span>$g_{FF}^M$</span> is in 1 / (m mol / L) where that <code>m</code> in <code>m</code>eters, so we need to multiply by a factor of <span>$10^{-6}$</span> to get 1 / (m μmol / L)</li><li>The fraction of bacterially consumed iron going to small and big particles, <span>$\kappa^{BFe}_{Bact}$</span> and <span>$\kappa^{SFe}_{Bact}$</span>, in equations 48 and 49 are not recorded but from the NEMO source code we can see that they are <code>0.04</code> and <code>0.12</code> respectively. Additionally, we need to multiply by a factor of <code>0.16</code> (<span>$bacterial_iron_uptake_efficiency$</span>) to the drawdown from the iron pool due to the instantaneous return (as per the NEMO version)</li><li><span>$\theta_{max}^{Fe, Bact}$</span> is not recorded so the value <code>0.06</code> μmol Fe / mmol C is taken from the NEMO source code</li><li><span>$\theta^{Fe, Z}$</span> and <span>$\theta^{Fe, M}$</span> are taken from the NEMO source code to be 0.01 and 0.015 μmol Fe / mmol C</li><li><span>$\theta_{max}^{Fe, P}$</span> is taken from the NEMO source code to be <code>0.06</code> μmol Fe / mmol C, we note that this isn&#39;t actually the maximum in the sense that the ratio could (probably) go above this value</li><li><span>$K^{B, 1}_{Fe}$</span> is not recorded so the value <code>0.3</code> μmol Fe / m³ is taken from the NEMO source code</li><li><span>$\eta^Z$</span> and <span>$\eta^M$</span> in equation 76 are incorrectly labelled as <span>$\nu^I$</span> in parameter table</li><li>Iron ratios are often given as mol Fe / mol C, so we have converted to μmol Fe / mmol C</li></ul><h2 id="Equation-disparities"><a class="docs-heading-anchor" href="#Equation-disparities">Equation disparities</a><a id="Equation-disparities-1"></a><a class="docs-heading-anchor-permalink" href="#Equation-disparities" title="Permalink"></a></h2><ul><li>The calcite production limitation, <span>$L^{CaCO_3}_{lim}$</span> in equation 77, is not documented. From the NEMO source code it appears to take the form <span>$L^{CaCO_3}_{lim} = min(L_N^P, L_{PO_4}^P, L_{Fe})$</span> where <span>$L_{Fe} = Fe / (Fe + 0.05)$</span>. Additionally, in the NEMO source code <span>$L_{PO_4}$</span> is <span>$PO_4 / (PO_4 + K^{P, min}_{NH_4})$</span> but that didn&#39;t make sense to us so we assumed it was <span>$L_{PO_4}^P$</span></li><li>The temperature factor in calcite production is supposed to bring the production to zero when the temperature goes below 0°C but in the documented form does not, it was changed to <span>$max(0, T / (T + 0.1))$</span></li><li>We think there is an additional factor of <span>$Diss_{Si}$</span> in the <span>$PSi$</span> equation (51) so have neglected it</li><li>A factor of <span>$R_{NH_4}$</span> appears in the nitrate equation which is undefined, and we did not track down in the NEMO source code so have neglected</li><li>The form of <span>$K^{Fe}_{eq}$</span> in equation 65 is not given, so we took the form <span>$\exp\left(16.27 - 1565.7 / max(T + 273.15, 5)\right)$</span> from the NEMO source code</li><li>Equation 32 contains a typo, the second term should be <span>$(1 - \gamma ^M)(1 - e^M - \sigma^M)(\sum \textcolor{red}{g^M (I)} + g_{FF}^M(GOC))M$</span></li><li>Equation 37 is missing a factor of <span>$3\Delta O_2$</span> in the third term, and <span>$sh$</span> in the fifth term</li><li>Equation 40 is missing a factor of <span>$sh$</span> in the third and fourth terms, and is missing a <span>$+$</span> in the fourth term which should read <span>$0.5m^D \frac{D}{D+K_m}D + sh \times w^D D^2$</span></li><li>Equation 48 is missing a factor of <span>$3\Delta O_2$</span> in the second term, and a factor of <span>$Z$</span> in the penultimate term</li><li>Equation 49 is missing a factor of <span>$3\Delta O_2$</span> in the second term</li><li>Equations 54 and 55 are missing factors of the Redfield ratio in all terms except nitrification, nitrogen fixation. Additionally, we think that the term <span>$R_{NH_4}\lambda_{NH_4}\Delta(O_2)NH_4$</span> is not meant to be present and can not work out its utility or parameter values so have neglected</li><li>Equation 60 is missing a factor of <span>$e^Z$</span> in the first term and <span>$e^M$</span>, but for clarity we have rewritten it as:</li></ul><p class="math-container">\[\frac{\partial Fe}{\partial t} += \sum_J^{Z, M}\left[J\max\left(0, (1 - \sigma)\sum_I{g^J(I)\theta^{Fe, I}} - e^J\theta^{Fe, J}\sum_I{g^J(I)} \right)\right],\]</p><p>which is the total iron grazed, minus the amount which is routed to particles, minus the amount stored in the zooplankton (and is identical with different simplification to the original)</p><ul><li>Equation 19 has a typo and <span>$L^{I^Fe}_{lim, 2}$</span> should read <span>$4 - 4.5 LFe / (LFe + 1)$</span></li><li>In equation 33, the <code>min</code> parts did not make sense (and we don&#39;t think are present in the NEMO source code), and so have been neglected</li><li>The first term in equation 14 should read <span>$(1-\delta^I)12 (\theta_{min}^{Chl, I} + \rho(\theta_{max}^{Chl, I}-\theta_{min}^{Chl, I}))\mu^I I$</span> and <span>$\rho$</span> should be given by <span>$L_{day}\frac{\mu I}{f_1}L\frac{12I}{IChl}\frac{L_P}{\alpha PAR}$</span>, maybe this is what it says, but it was not clear</li></ul><h2 id="Changes-since-[Aumont2015](@citet)-in-NEMO"><a class="docs-heading-anchor" href="#Changes-since-[Aumont2015](@citet)-in-NEMO">Changes since <a href="../../../../references/#Aumont2015">Aumont <em>et al.</em> (2015)</a> in NEMO</a><a id="Changes-since-[Aumont2015](@citet)-in-NEMO-1"></a><a class="docs-heading-anchor-permalink" href="#Changes-since-[Aumont2015](@citet)-in-NEMO" title="Permalink"></a></h2><ul><li>Diatom quadratic mortality has changed forms to <span>$w^D=w^P + 0.25 w^D_{max} \frac{1 - (L^D_{lim})^2}{0.25 + (L^D_{lim})^2}$</span></li><li>The P-I slope, <span>$\alpha$</span>, can vary for adaptation to depth, but the default is no enhancement. This can be included in our version by setting <code>low_light_adaptation</code> to be non-zero in the growth rate parameterisations</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../PISCES/">« PISCES</a><a class="docs-footer-nextpage" href="../../../air-sea-gas/">Air-sea gas exchange »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 23 October 2025 16:11">Thursday 23 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
