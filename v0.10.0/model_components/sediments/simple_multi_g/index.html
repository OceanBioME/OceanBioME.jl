<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simple Multi-G · OceanBioME.jl</title><meta name="title" content="Simple Multi-G · OceanBioME.jl"/><meta property="og:title" content="Simple Multi-G · OceanBioME.jl"/><meta property="twitter:title" content="Simple Multi-G · OceanBioME.jl"/><meta name="description" content="Documentation for OceanBioME.jl."/><meta property="og:description" content="Documentation for OceanBioME.jl."/><meta property="twitter:description" content="Documentation for OceanBioME.jl."/><meta property="og:url" content="https://OceanBioME.github.io/OceanBioME/stable/model_components/sediments/simple_multi_g/"/><meta property="twitter:url" content="https://OceanBioME.github.io/OceanBioME/stable/model_components/sediments/simple_multi_g/"/><link rel="canonical" href="https://OceanBioME.github.io/OceanBioME/stable/model_components/sediments/simple_multi_g/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.png" alt="OceanBioME.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.png" alt="OceanBioME.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">OceanBioME.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../quick_start/">Quick start</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/box/">Box model</a></li><li><a class="tocitem" href="../../../generated/column/">Simple column model</a></li><li><a class="tocitem" href="../../../generated/eady/">Baroclinic instability</a></li><li><a class="tocitem" href="../../../generated/data_forced/">Data forced column model</a></li><li><a class="tocitem" href="../../../generated/kelp/">Model with particles (kelp) interacting with the biogeochemistry</a></li><li><a class="tocitem" href="../../../generated/data_assimilation/">Data assimilation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model components and setup</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Biogeochemical models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../biogeochemical/">Overview</a></li><li><a class="tocitem" href="../../biogeochemical/LOBSTER/">LOBSTER</a></li><li><a class="tocitem" href="../../biogeochemical/NPZ/">NPZD</a></li></ul></li><li><a class="tocitem" href="../../air-sea-gas/">Air-sea gas exchange</a></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox" checked/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Sediment models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Overview</a></li><li class="is-active"><a class="tocitem" href>Simple Multi-G</a><ul class="internal"><li><a class="tocitem" href="#Model-conservations"><span>Model conservations</span></a></li><li><a class="tocitem" href="#Model-compatibility"><span>Model compatibility</span></a></li></ul></li><li><a class="tocitem" href="../instant_remineralisation/">Instant remineralisation</a></li></ul></li><li><a class="tocitem" href="../../light/">Light attenuation models</a></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Individuals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../individuals/">Overview</a></li><li><a class="tocitem" href="../../individuals/slatissima/">Sugar Kelp (Broch and Slagstad 2012 ++)</a></li></ul></li><li><a class="tocitem" href="../../utils/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../../model_implementation/">Implementing new models</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../numerical_implementation/positivity-preservation/">Positivity preservation</a></li></ul></li><li><a class="tocitem" href="../../../visualization/">Visualization</a></li><li><a class="tocitem" href="../../../contributing/">Contibutors guide</a></li><li><a class="tocitem" href="../../../references/">References</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../appendix/library/">Library</a></li><li><a class="tocitem" href="../../../appendix/function_index/">Function index</a></li><li><input class="collapse-toggle" id="menuitem-10-3" type="checkbox"/><label class="tocitem" for="menuitem-10-3"><span class="docs-label">Parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/LOBSTER_parameters/">LOBSTER</a></li><li><a class="tocitem" href="../../../generated/NutrientPhytoplanktonZooplanktonDetritus_parameters/">NutrientPhytoplanktonZooplanktonDetritus</a></li><li><a class="tocitem" href="../../../generated/SLatissima_parameters/">SLatissima</a></li><li><a class="tocitem" href="../../../generated/TwoBandPhotosyntheticallyActiveRadiation_parameters/">TwoBandPhotosyntheticallyActiveRadiation</a></li><li><a class="tocitem" href="../../../generated/SimpleMultiG_parameters/">SimpleMultiG</a></li><li><a class="tocitem" href="../../../generated/InstantRemineralisation_parameters/">InstantRemineralisation</a></li><li><a class="tocitem" href="../../../generated/OceanBioME.Boundaries.pCO₂_parameters/">OceanBioME.Boundaries.pCO₂</a></li><li><a class="tocitem" href="../../../generated/CO₂ air-sea exchange_parameters/">CO₂ air-sea exchange</a></li><li><a class="tocitem" href="../../../generated/O₂ air-sea exchange_parameters/">O₂ air-sea exchange</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model components and setup</a></li><li><a class="is-disabled">Sediment models</a></li><li class="is-active"><a href>Simple Multi-G</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simple Multi-G</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/OceanBioME/OceanBioME.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/OceanBioME/OceanBioME.jl/blob/main/docs/src/model_components/sediments/simple_multi_g.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="multi-g"><a class="docs-heading-anchor" href="#multi-g">Simple multi-G</a><a id="multi-g-1"></a><a class="docs-heading-anchor-permalink" href="#multi-g" title="Permalink"></a></h1><p>This model, proposed by <a href="../../../references/#Soetaert2000">Soetaert <em>et al.</em> (2000)</a>, is a &quot;G class&quot; model that evolves carbon and nitrogen in three classes (fast, slow and refectory). The model is also only compatible with the LOBSTER biogeochemical model with carbonate chemistry, oxygen, and variable redfield options on. You also must ensure that the <code>open_bottom</code> option is on for particles to leave the bottom of the domain to the sediment model.</p><p>It is straightforward to set up:</p><pre><code class="language-julia hljs">using OceanBioME, Oceananigans, OceanBioME.Sediments

grid = RectilinearGrid(size=(3, 3, 30), extent=(10, 10, 200))

sediment_model = SimpleMultiG(; grid)

# output
┌ Warning: Sediment models are an experimental feature and have not yet been validated.
└ @ OceanBioME.Boundaries.Sediments ~/OceanBioME.jl/src/Boundaries/Sediments/simple_multi_G.jl:102
[ Info: This sediment model is currently only compatible with models providing NH₄, NO₃, O₂, and DIC.
Single-layer multi-G sediment model (Float64)</code></pre><p>You may optionally specify the model parameters. This can then be passed in the setup of a BGC model:</p><pre><code class="language-julia hljs">biogeochemistry = LOBSTER(; grid, 
                            carbonates = true, oxygen = true, variable_redfield = true, 
                            open_bottom = true, 
                            sediment_model)</code></pre><h3 id="Model-equations"><a class="docs-heading-anchor" href="#Model-equations">Model equations</a><a id="Model-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Model-equations" title="Permalink"></a></h3><p>This model evolved the carbon and nitrogen components of three liability classes: fast, slow, and refractory. Each component is remineralised with first order decay so evolved like:</p><p class="math-container">\[\frac{dX_i}{dt} = F_{X_i} - \lambda_iX_i.\]</p><p>For the fast and slow classes <span>$\lambda$</span> is a positive, non-zero, rate constant, and for the refractory class it is <span>$0$</span>. <span>$F_{X_i}$</span> is the flux, and the flux for each class is simply a constant fraction of the total flux:</p><p class="math-container">\[F_{X_i} = f_iF_X.\]</p><p>The fraction of remineralised sediment (<span>$X_\text{min} = \Sigma_i\lambda_{X_i}X_i$</span>) that becomes ammonia or nitrate depends on the equilibrium of chemical equations dependent on the bottom water <span>$NO_3$</span>, <span>$NH_4$</span>, and <span>$O_2$</span> concentrations, as well as the total remineralisation and mean degradation rate. The mean first order degredation rate is given by:</p><p class="math-container">\[k = \frac{\lambda_\text{fast} C_\text{fast} + \lambda_\text{slow} C_\text{slow}}{C_\text{fast} + C_\text{slow}},\]</p><p>and, based on <a href="../../../references/#Soetaert2000">Soetaert <em>et al.</em> (2000)</a>, the fraction nitrified (i.e becoming nitrate rather than ammonia) is given by:</p><p class="math-container">\[\ln\left(C_\text{min}p_{nit}\right) = n_A + n_B\ln C_\text{min}\ln O_2 + n_C * \ln C_\text{min} ^ 2 + n_D * \ln k \ln NH_4 + n_E \ln C_\text{min} + n_F \ln C_\text{min} \ln NH_4.\]</p><p>Therefore, the efflux of nitrate and ammonia are given by:</p><p class="math-container">\[\frac{\partial NO_3}{\partial t} =\frac{N_\text{min}p_\text{nit}}{\Delta z},\]</p><p class="math-container">\[\frac{\partial NH_4}{\partial t} = \frac{N_\text{min}(1 - p_\text{nit})}{\Delta z},\]</p><p>where <span>$\Delta z$</span> is the depth of the bottom cell (since <span>$X_i$</span> is a surface concentration). This mineralisation also consumes oxygen at a rate:</p><p class="math-container">\[\frac{\partial O_2}{\partial t} =\frac{C_\text{min}(1 - p_\text{anox}p_\text{solid deposition}) + N_\text{min}p_\text{nit} O:N}{\Delta z},\]</p><p>where the constants are given by:</p><p class="math-container">\[p_\text{solid deposition} = s_A w ^{s_B},\]</p><p>with, <span>$w = s_CD^{s_D}$</span> where <span>$D$</span> is the water depth.</p><p class="math-container">\[\ln\left(C_\text{min}p_\text{anox}\right) = a_A + a_B\ln C_\text{min} + a_C \ln C_\text{min} ^ 2 + a_D \ln k + a_E \ln O_2 \ln k + a_F \ln NO_3 ^2.\]</p><p>The original model of <a href="../../../references/#Soetaert2000">Soetaert <em>et al.</em> (2000)</a> also includes denitrification terms whereby nitrogen is returned to the water column as dissolved <span>$N_2$</span>, but we currently do not account for this in order to conserve the nitrogen budget.</p><h3 id="Parameter-variable-names"><a class="docs-heading-anchor" href="#Parameter-variable-names">Parameter variable names</a><a id="Parameter-variable-names-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-variable-names" title="Permalink"></a></h3><table><tr><th style="text-align: right">Symbol</th><th style="text-align: right">Variable name</th><th style="text-align: right">Units</th></tr><tr><td style="text-align: right"><span>$\lambda_\text{fast}$</span></td><td style="text-align: right"><code>fast_decay_rate</code></td><td style="text-align: right">1 / s</td></tr><tr><td style="text-align: right"><span>$\lambda_\text{slow}$</span></td><td style="text-align: right"><code>slow_decay_rate</code></td><td style="text-align: right">1 / s</td></tr><tr><td style="text-align: right"><span>$f_\text{fast}$</span></td><td style="text-align: right"><code>fast_fraction</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$f_\text{slow}$</span></td><td style="text-align: right"><code>slow_fraction</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$f_\text{ref}$</span></td><td style="text-align: right"><code>refactory_fraction</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$n_i$</span></td><td style="text-align: right"><code>nitrate_oxidation_params</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$a_i$</span></td><td style="text-align: right"><code>anoxic_param</code></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$s_i$</span></td><td style="text-align: right"><code>solid_dep_params</code></td><td style="text-align: right">-</td></tr></table><p>All parameters are given in <a href="../../../appendix/params/#parameters">Parameters</a>. </p><h2 id="Model-conservations"><a class="docs-heading-anchor" href="#Model-conservations">Model conservations</a><a id="Model-conservations-1"></a><a class="docs-heading-anchor-permalink" href="#Model-conservations" title="Permalink"></a></h2><p>Nitrogen and carbon is conserved between the model domain and sediment, any nitrogen or carbon not returned to the bottom cell is stored in a sediment field.</p><h2 id="Model-compatibility"><a class="docs-heading-anchor" href="#Model-compatibility">Model compatibility</a><a id="Model-compatibility-1"></a><a class="docs-heading-anchor-permalink" href="#Model-compatibility" title="Permalink"></a></h2><p>This model is currently only compatible with the <a href="../../biogeochemical/LOBSTER/#LOBSTER">LOBSTER</a> biogeochemical model.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Overview</a><a class="docs-footer-nextpage" href="../instant_remineralisation/">Instant remineralisation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 1 February 2024 07:08">Thursday 1 February 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
